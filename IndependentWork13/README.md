# –°–∞–º–æ—Å—Ç—ñ–π–Ω–∞ —Ä–æ–±–æ—Ç–∞ ‚Ññ13: –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è –ø–æ–ª—ñ—Ç–∏–∫ –≤—ñ–¥–º–æ–≤–æ—Å—Ç—ñ–π–∫–æ—Å—Ç—ñ –∑ Polly

**–¢–µ–º–∞:** *–ö–µ–π—Å–∏ Polly/Retry: –∫–æ—Ä–æ—Ç–∫–∏–π –∑–≤—ñ—Ç.*
**–ú–µ—Ç–∞:** *–î–æ—Å–ª—ñ–¥–∏—Ç–∏ —Ç–∞ –ø—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —Ä–µ–∞–ª—å–Ω—ñ —Å—Ü–µ–Ω–∞—Ä—ñ—ó –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ Polly –¥–ª—è —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –ø–æ–ª—ñ—Ç–∏–∫ –≤—ñ–¥–º–æ–≤–æ—Å—Ç—ñ–π–∫–æ—Å—Ç—ñ (Retry, Circuit Breaker, Timeout) —É .NET-–∑–∞—Å—Ç–æ—Å—É–Ω–∫–∞—Ö.*
## üìã –û–ø–∏—Å –ø—Ä–æ—î–∫—Ç—É
–¶–µ–π –∫–æ–Ω—Å–æ–ª—å–Ω–∏–π –∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫ –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è .NET –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ **Polly** –¥–ª—è –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è —Å—Ç—ñ–π–∫–æ—Å—Ç—ñ (resiliency) –ø—Ä–æ–≥—Ä–∞–º–Ω–æ–≥–æ –∑–∞–±–µ–∑–ø–µ—á–µ–Ω–Ω—è. –ü—Ä–æ—î–∫—Ç —ñ–º—ñ—Ç—É—î —Ä–µ–∞–ª—å–Ω—ñ —Å—Ü–µ–Ω–∞—Ä—ñ—ó –∑–±–æ—ó–≤ —É —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö —Ç–∞ –ø–æ–∫–∞–∑—É—î, —è–∫ –∫–æ—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–æ–±–ª—è—Ç–∏ –ø–æ–º–∏–ª–∫–∏, –Ω–µ –¥–æ–ø—É—Å–∫–∞—é—á–∏ –ø–∞–¥—ñ–Ω–Ω—è –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É.


---

## üöÄ –†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ —Å—Ü–µ–Ω–∞—Ä—ñ—ó

### –°—Ü–µ–Ω–∞—Ä—ñ–π 1: –ù–µ—Å—Ç–∞–±—ñ–ª—å–Ω–∏–π –∑–æ–≤–Ω—ñ—à–Ω—ñ–π API (Retry Policy)
**–ü—Ä–æ–±–ª–µ–º–∞:**
–ü—ñ–¥ —á–∞—Å –∑–≤–µ—Ä–Ω–µ–Ω–Ω—è –¥–æ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö HTTP-—Å–µ—Ä–≤—ñ—Å—ñ–≤ —á–∞—Å—Ç–æ –≤–∏–Ω–∏–∫–∞—é—Ç—å –∫–æ—Ä–æ—Ç–∫–æ—á–∞—Å–Ω—ñ ("–º–∏–≥–æ—Ç–ª–∏–≤—ñ") –∑–±–æ—ó ‚Äî –≤—Ç—Ä–∞—Ç–∞ –ø–∞–∫–µ—Ç—ñ–≤, –ø–æ–º–∏–ª–∫–∏ 503 Service Unavailable —Ç–æ—â–æ. –ú–∏—Ç—Ç—î–≤–µ –ø–µ—Ä–µ—Ä–∏–≤–∞–Ω–Ω—è —Ä–æ–±–æ—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º–∏ –≤ —Ç–∞–∫–∏—Ö –≤–∏–ø–∞–¥–∫–∞—Ö —î –Ω–µ–¥–æ—Ü—ñ–ª—å–Ω–∏–º.

**–†—ñ—à–µ–Ω–Ω—è (–ü–æ–ª—ñ—Ç–∏–∫–∞):** `WaitAndRetry`
–ú–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Å—Ç—Ä–∞—Ç–µ–≥—ñ—é **–µ–∫—Å–ø–æ–Ω–µ–Ω—Ü—ñ–π–Ω–æ—ó –∑–∞—Ç—Ä–∏–º–∫–∏ (Exponential Backoff)**.
* **–ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è:** 3 —Å–ø—Ä–æ–±–∏ –ø–æ–≤—Ç–æ—Ä—É.
* **–ê–ª–≥–æ—Ä–∏—Ç–º –∑–∞—Ç—Ä–∏–º–∫–∏:** $2^n$ —Å–µ–∫—É–Ω–¥ (2—Å, 4—Å, 8—Å).
* **–û–±“ë—Ä—É–Ω—Ç—É–≤–∞–Ω–Ω—è:** –ü–æ—Å—Ç—É–ø–æ–≤–µ –∑–±—ñ–ª—å—à–µ–Ω–Ω—è —ñ–Ω—Ç–µ—Ä–≤–∞–ª—É –º—ñ–∂ –∑–∞–ø–∏—Ç–∞–º–∏ –¥–∞—î —Å–µ—Ä–≤—ñ—Å—É —á–∞—Å –Ω–∞ –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è —ñ –∑–∞–ø–æ–±—ñ–≥–∞—î –π–æ–≥–æ –ø–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—é (DDoS-–µ—Ñ–µ–∫—Ç –≤—ñ–¥ –∫–ª—ñ—î–Ω—Ç–∞).

---

### –°—Ü–µ–Ω–∞—Ä—ñ–π 2: –ü–µ—Ä–µ–≤–∞–Ω—Ç–∞–∂–µ–Ω–∞ –ë–∞–∑–∞ –î–∞–Ω–∏—Ö (Circuit Breaker)
**–ü—Ä–æ–±–ª–µ–º–∞:**
–Ø–∫—â–æ –±–∞–∑–∞ –¥–∞–Ω–∏—Ö –∞–±–æ –º—ñ–∫—Ä–æ—Å–µ—Ä–≤—ñ—Å "–≤–ø–∞–ª–∏" (–ø–æ—Å—Ç—ñ–π–Ω–∏–π TimeOut –∞–±–æ Connection Refused), –ø—Ä–æ–¥–æ–≤–∂—É–≤–∞—Ç–∏ –Ω–∞–¥—Å–∏–ª–∞—Ç–∏ –∑–∞–ø–∏—Ç–∏ –±–µ–∑–≥–ª—É–∑–¥–æ. –¶–µ –ª–∏—à–µ –≤–∏—Ç—Ä–∞—á–∞—î —Ä–µ—Å—É—Ä—Å–∏ –∫–ª—ñ—î–Ω—Ç–∞ —ñ –∑–∞–≤–∞–∂–∞—î —Å–µ—Ä–≤–µ—Ä—É –ø—ñ–¥–Ω—è—Ç–∏—Å—è.

**–†—ñ—à–µ–Ω–Ω—è (–ü–æ–ª—ñ—Ç–∏–∫–∞):** `CircuitBreaker` (–ó–∞–ø–æ–±—ñ–∂–Ω–∏–∫)
–ü–∞—Ç–µ—Ä–Ω –ø—Ä–∞—Ü—é—î —è–∫ –µ–ª–µ–∫—Ç—Ä–∏—á–Ω–∏–π –∞–≤—Ç–æ–º–∞—Ç:
1.  **Closed (–ù–æ—Ä–º–∞):** –ó–∞–ø–∏—Ç–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç—å.
2.  **Open (–ó–±—ñ–π):** –ü—ñ—Å–ª—è **2-—Ö –ø–æ–º–∏–ª–æ–∫ –ø–æ—Å–ø—ñ–ª—å** –ª–∞–Ω—Ü—é–≥ —Ä–æ–∑–º–∏–∫–∞—î—Ç—å—Å—è. –ù–∞—Å—Ç—É–ø–Ω—ñ –∑–∞–ø–∏—Ç–∏ –º–∏—Ç—Ç—î–≤–æ –≤—ñ–¥—Ö–∏–ª—è—é—Ç—å—Å—è –∑ –ø–æ–º–∏–ª–∫–æ—é `BrokenCircuitException` –±–µ–∑ –∑–≤–µ—Ä–Ω–µ–Ω–Ω—è –¥–æ –ë–î.
3.  **Half-Open (–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞):** –ß–µ—Ä–µ–∑ **5 —Å–µ–∫—É–Ω–¥** Polly –ø—Ä–æ–ø—É—Å–∫–∞—î –æ–¥–∏–Ω –ø—Ä–æ–±–Ω–∏–π –∑–∞–ø–∏—Ç. –Ø–∫—â–æ –≤—ñ–Ω —É—Å–ø—ñ—à–Ω–∏–π ‚Äî –ª–∞–Ω—Ü—é–≥ –∑–∞–º–∏–∫–∞—î—Ç—å—Å—è, —è–∫—â–æ –Ω—ñ ‚Äî –∑–Ω–æ–≤—É —Ä–æ–∑–º–∏–∫–∞—î—Ç—å—Å—è.

**–û–±“ë—Ä—É–Ω—Ç—É–≤–∞–Ω–Ω—è:** –¶–µ –¥–æ–∑–≤–æ–ª—è—î —Å–∏—Å—Ç–µ–º—ñ "fail fast" (—à–≤–∏–¥–∫–æ –ø–∞–¥–∞—Ç–∏), –Ω–µ –±–ª–æ–∫—É—é—á–∏ –ø–æ—Ç–æ–∫–∏ –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è–º –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –≤—ñ–¥ –º–µ—Ä—Ç–≤–æ–≥–æ —Å–µ—Ä–≤—ñ—Å—É.

---

### –°—Ü–µ–Ω–∞—Ä—ñ–π 3: –î–æ–≤–≥–∞ –æ–ø–µ—Ä–∞—Ü—ñ—è (Timeout + Fallback)
**–ü—Ä–æ–±–ª–µ–º–∞:**
–û–±—Ä–æ–±–∫–∞ —Ñ–∞–π–ª—É –∞–±–æ –∑–∞–ø–∏—Ç –º–æ–∂—É—Ç—å "–∑–∞–≤–∏—Å–Ω—É—Ç–∏" –Ω–∞ –Ω–µ–≤–∏–∑–Ω–∞—á–µ–Ω–∏–π —á–∞—Å, –ø–æ–≥—ñ—Ä—à—É—é—á–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–∏–π –¥–æ—Å–≤—ñ–¥ (UX). –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–µ –ø–æ–≤–∏–Ω–µ–Ω —á–µ–∫–∞—Ç–∏ –≤—ñ—á–Ω–æ.

**–†—ñ—à–µ–Ω–Ω—è (–ü–æ–ª—ñ—Ç–∏–∫–∞):** `Timeout` (Wrap –∑ `Fallback`)
* **Timeout:** –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∂–æ—Ä—Å—Ç–∫–∏–π –ª—ñ–º—ñ—Ç –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –æ–ø–µ—Ä–∞—Ü—ñ—ó ‚Äî **3 —Å–µ–∫—É–Ω–¥–∏**.
* **Fallback:** –Ø–∫—â–æ –æ–ø–µ—Ä–∞—Ü—ñ—è –Ω–µ –≤—Å—Ç–∏–≥–ª–∞ –≤–∏–∫–æ–Ω–∞—Ç–∏—Å—è –∞–±–æ –≤–∏–Ω–∏–∫–ª–∞ –ø–æ–º–∏–ª–∫–∞, –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è —Ä–µ–∑–µ—Ä–≤–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è ("Default Cached Data").

**–û–±“ë—Ä—É–Ω—Ç—É–≤–∞–Ω–Ω—è:** –¢–∞–∫–∞ –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—è –≥–∞—Ä–∞–Ω—Ç—É—î SLA (Service Level Agreement) ‚Äî —Å–∏—Å—Ç–µ–º–∞ –∑–∞–≤–∂–¥–∏ –≤—ñ–¥–ø–æ–≤—ñ—Å—Ç—å –∑–∞ –ø–µ—Ä–µ–¥–±–∞—á—É–≤–∞–Ω–∏–π —á–∞—Å, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ –Ω–µ –Ω–∞–π—Å–≤—ñ–∂—ñ—à–∏–º.

---