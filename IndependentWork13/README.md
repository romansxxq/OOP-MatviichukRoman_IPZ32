# Самостійна робота №13: Реалізація політик відмовостійкості з Polly

**Тема:** *Кейси Polly/Retry: короткий звіт.*
**Мета:** *Дослідити та проаналізувати реальні сценарії використання бібліотеки Polly для реалізації політик відмовостійкості (Retry, Circuit Breaker, Timeout) у .NET-застосунках.*
## Опис проєкту
Цей консольний застосунок демонструє використання .NET бібліотеки **Polly** для забезпечення стійкості (resiliency) програмного забезпечення. Проєкт імітує реальні сценарії збоїв у розподілених системах та показує, як коректно обробляти помилки, не допускаючи падіння застосунку.


---

## Реалізовані сценарії

### Сценарій 1: Нестабільний зовнішній API (Retry Policy)
**Проблема:**
Під час звернення до зовнішніх HTTP-сервісів часто виникають короткочасні ("миготливі") збої — втрата пакетів, помилки 503 Service Unavailable тощо. Миттєве переривання роботи програми в таких випадках є недоцільним.

**Рішення (Політика):** `WaitAndRetry`
Ми використовуємо стратегію **експоненційної затримки (Exponential Backoff)**.
* **Конфігурація:** 3 спроби повтору.
* **Алгоритм затримки:** $2^n$ секунд (2с, 4с, 8с).
* **Обґрунтування:** Поступове збільшення інтервалу між запитами дає сервісу час на відновлення і запобігає його перевантаженню (DDoS-ефект від клієнта).

---

### Сценарій 2: Перевантажена База Даних (Circuit Breaker)
**Проблема:**
Якщо база даних або мікросервіс "впали" (постійний TimeOut або Connection Refused), продовжувати надсилати запити безглуздо. Це лише витрачає ресурси клієнта і заважає серверу піднятися.

**Рішення (Політика):** `CircuitBreaker` (Запобіжник)
Патерн працює як електричний автомат:
1.  **Closed (Норма):** Запити проходять.
2.  **Open (Збій):** Після **2-х помилок поспіль** ланцюг розмикається. Наступні запити миттєво відхиляються з помилкою `BrokenCircuitException` без звернення до БД.
3.  **Half-Open (Перевірка):** Через **5 секунд** Polly пропускає один пробний запит. Якщо він успішний — ланцюг замикається, якщо ні — знову розмикається.

**Обґрунтування:** Це дозволяє системі "fail fast" (швидко падати), не блокуючи потоки очікуванням відповіді від мертвого сервісу.

---

### Сценарій 3: Довга операція (Timeout + Fallback)
**Проблема:**
Обробка файлу або запит можуть "зависнути" на невизначений час, погіршуючи користувацький досвід (UX). Користувач не повинен чекати вічно.

**Рішення (Політика):** `Timeout` (Wrap з `Fallback`)
* **Timeout:** Встановлено жорсткий ліміт виконання операції — **3 секунди**.
* **Fallback:** Якщо операція не встигла виконатися або виникла помилка, повертається резервне значення ("Default Cached Data").

**Обґрунтування:** Така комбінація гарантує SLA (Service Level Agreement) — система завжди відповість за передбачуваний час, навіть якщо результат буде не найсвіжішим.

---
